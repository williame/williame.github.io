<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    
    <base href=".."/>
    <link rel="stylesheet" type="text/css" href="static/style.css"/>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-27302158-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-27302158-1');
    </script>
    <title>WillCity update : Will Edward&#39;s Programming</title>
    <!--
    <post>
<title>WillCity update</title>
<date>2013-05-06</date>
<tag>rec</tag>
<tag>game</tag>
</post>
    -->
    
</head>
<body>
<div class="content">
<div class="column">
    <div style="width: 90%;" class="page-link" onclick="window.location='index.html'">
    <h1>Will Edwards<br/><i>programming</i></h1>
    </div>
    <p>Always loved programming - its like Lego without gravity.</p>
    <p>Basic on my ZX81 graduating to assembler and Turbo Pascal during my teens.</p>
    <p>Developed phone OS software - engineer, architect, product manager - but got made irrelevant by the
        iPhone and redundant by Android.</p>
    <p style="font-size: 16pt; width:90%;">These days I mostly work with <b>data</b>, <b>big data</b> and <b><i>fitting big data onto small boxes</i></b>.</p>
</div>
<div class="posts-column column">
<div class="page-title"><h1>WillCity update</h1></div>
<div class="post">
<post-body><p><img alt="image" src="media/old/49797579721_1.jpg"/></p>

                <p><a href="post/49171822294.html" target="_blank">Previously</a>, <a href="post/20163196047.html" target="_blank">previously</a>.</p>
                <p>When run on local-host, the game runs four sims at once, in lock-step.  Three of them are test
                patterns, and the top left is for playing around.</p>
                <p>This makes it very easy to try out and tweak algorithms!</p>
                <p>The top-left layout - residential is red, industrial is pink and commercial blue - is supposed
                to be fairly optimal.  I want the algorithm to favour it, which you can see at the moment it does!</p>
                <p>The bottom left has more space between the zones, and road only on one side.  The algorithm
                should favour growth near the road, and at the moment it does!</p>
                <p>The bottom right is a very sub-optimal layout and I want the algorithm to punish it.
                 Commercial and industrial don’t like each other (although the commercial cares more than the
                industrial).</p>
                <p>The early sims are quite pleasing, but after a while - just a few years since my whole timeline
                thing is not quite set up - things get out of whack and success breeds success and it becomes a run-away
                chain reaction.  I need to think about levelling and damping and so on.</p>
                <p>I’ve been talking to the <a href="http://www.opencity.info/" target="_blank">OpenCity</a>
                devs and the way their algorithm works is:</p>
                <ol><li>each sim step, pick a random residential, commercial or industrial zone to re-score.
                 It doesn’t recompute the scores for all zones each time step.  Change is gradual.</li>
                <li>in a NxN grid, see if there are any of the other two zone types</li>
                <li>depending on the zone type, reward or penalise nearby other zone types</li>
                <li>if the reward is positive, there’s a small chance that the zone will level up</li>
                <li>if the reward is negative, there’s a small chance that the zone will level down</li>
                </ol><p>I have a slightly more computationally-expensive approach, although far from the
                simple balance in OpenCity:</p>
                <ol><li>each sim step, pick between 1 and N% of the RCI zones are re-scored</li>
                <li>for each re-scoring zone,</li>
                <li>perform a best-first search to determine all the other zones within reach</li>
                <li>the transport cost uses one of three transport cost layers - car_and_foot, bus and train.  The
                best-first search can jump between these layers at bus stops and train stations</li>
                <li>at this point I have a list of nearby zones for each type and how far it is away and its score
                and so on; a quite complicated and nuanced algorithm could use all this data.  For now, we do something
                rather simple:</li>
                <li>average the distance*score of each nearby zone type</li>
                <li>if the zone is residential, re-score = commerical_score + industrial_score +
                residential_score*0.1</li>
                <li>if the zone is commercial, re-score = residential_score - industrial_score +
                commercial_score*0.1</li>
                <li>and so on</li>
                <li>then, if the re-score is more than the current score, there’s a 25% probability that
                5% of the difference is added to the zone’s score</li>
                <li>and inverse for re-scoring down</li>
                <li>with some basic clamping</li>
                </ol>
            </post-body>
 <button class="page-link" onclick="window.location='rec1.html#49797579721'">rec</button>  <button class="page-link" onclick="window.location='game.html#49797579721'">game</button>  <button class="page-link" onclick="window.location='index2.html#49797579721'">index</button> 
</div>
</div>
</div>


<div class="column">
    <div class="page-map">
        
            <div class="page-link" onclick="window.location='index.html'">main&nbsp;page&nbsp;&uarr;</div>
            <hr/>
        
        
            


        
            

    <div class="page-map-branch">
    <b>performance</b>
        
            <img class="feather" src="static/icons/bar-chart-2.svg"/>
        
        
            <div class="page-map-section">
            
                
                    <div class="page-map-leaf" onclick="window.location='post/172424230628.html'">Faster searches with non-prefix fields in composite indices</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/160628887798.html'">Compressing MySQL databases</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/53836725910.html'">What highscalability.com says about Scaling my Server</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/53751799442.html'">Scaling my Server: follow-up</div>
                
            
                
                    <div class="page-link" onclick="window.location='perf.html'">more&nbsp;&rarr;</div>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            </div>
        
    </div>


        
            

    <div class="page-map-branch">
    <b>old classics</b>
        
            <img class="feather" src="static/icons/book-open.svg"/>
        
        
            <div class="page-map-section">
            
                
                    <div class="page-map-leaf" onclick="window.location='post/49786413417.html'">The kid&#39;s computer</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/37291851878.html'">Making the History of Worlds Religions map</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/25564136097.html'">If you defend those involved in the OpenGL ES specification, you are an idiot</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/25426541504.html'">Stackoverflow unwinding?</div>
                
            
                
                    <div class="page-link" onclick="window.location='classic.html'">more&nbsp;&rarr;</div>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            </div>
        
    </div>


        
            

    <div class="page-map-branch">
    <b>general</b>
        
            <img class="feather" src="static/icons/terminal.svg"/>
        
        
            <div class="page-map-section">
            
                
                    <div class="page-map-leaf" onclick="window.location='post/134911547413.html'">Why Swift?</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/94734034483.html'">Python annotations and type checking</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/86488099258.html'">pycon 2014 Sweden: the bad bits</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/78636919764.html'">Table-based Template Translation in C++</div>
                
            
                
                    <div class="page-link" onclick="window.location='lang.html'">more&nbsp;&rarr;</div>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            </div>
        
    </div>


        
            

    <div class="page-map-branch">
    <b>recreation</b>
        
            <img class="feather" src="static/icons/youtube.svg"/>
        
        
            <div class="page-link" onclick="window.location='rec.html'">all&nbsp;&rarr;</div>
            <div class="page-map-section">
            
                

    <div class="page-map-branch">
    <b>games programming</b>
        
            <img class="feather" src="static/icons/play.svg"/>
        
        
            <div class="page-map-section">
            
                
                    <div class="page-map-leaf" onclick="window.location='post/57140204975.html'">Perlin Noise</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/57181055984.html'">Perlin Noise</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/53831974133.html'">Drawing RTS maps fast</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/49797579721.html'">WillCity update</div>
                
            
                
                    <div class="page-link" onclick="window.location='game.html'">more&nbsp;&rarr;</div>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            </div>
        
    </div>


            
                

    <div class="page-map-branch">
    <b>ludum-dare</b>
        
        
            <div class="page-map-section">
            
                
                    <div class="page-map-leaf" onclick="window.location='post/143376853353.html'">Ludum Dare #35 Mosaic</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/127137593983.html'">LudumDare 33 wallpapers</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/117234199303.html'">SSIM vs MSE for Mosaics</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/97634254788.html'">Ludum Dare 30 results are in!</div>
                
            
                
                    <div class="page-link" onclick="window.location='ludum-dare.html'">more&nbsp;&rarr;</div>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            </div>
        
    </div>


            
            </div>
        
    </div>


        
        
    </div>
</div>
</body>
</html>