<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    
    <base href=".."/>
    <link rel="stylesheet" type="text/css" href="static/style.css"/>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-27302158-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-27302158-1');
    </script>
    <title>I know someone whose 2-factor phone authentication was hacked... : Will Edward&#39;s Programming</title>
    <!--
    <post>
<title>I know someone whose 2-factor phone authentication was hacked...</title>
<date>2012-06-12</date>
<tag>classic</tag>
</post>
    -->
    
</head>
<body>
<div class="content">
<div class="column">
    <div style="width: 90%;" class="page-link" onclick="window.location='index.html'">
    <h1>Will Edwards<br/><i>programming</i></h1>
    </div>
    <p><b>I have always loved programming</b> - its like Lego without gravity.</p>
    <p>Basic on my ZX81 graduating to assembler and Turbo Pascal during my teens.</p>
    <p>Developed phone OS software - engineer, architect, product manager - but got made irrelevant by the
        iPhone and redundant by Android.</p>
    <p style="font-size: 16pt; width:90%;">These days I mostly work with <b>data</b>, <b>big data</b> and <b><i>fitting big data onto small boxes</i></b>.</p>
</div>
<div class="posts-column column">
<div class="page-title"><h1>I know someone whose 2-factor phone authentication was hacked...</h1></div>
<div class="post">
<post-body><p>Password hashing best practice (TL;DR <a href="https://yorickpeterse.com/articles/use-bcrypt-fool" target="_blank">use bcrypt</a>) has
                been a bit in the spotlight recently.</p>
                <p>There has been a natural progression in the blogosphere as it tracks <a href="https://blog.linkedin.com/2012/06/06/linkedin-member-passwords-compromised/" target="_blank">LinkedIn’s
                shame</a>.  Yes you should use a password hash function with integrated salting e.g. bcrypt or
                scrypt.  Yes its scary reading developers comment as they fuddle through trying to invent their own
                solution in the comments to stories.</p>
                <p>And that blogosphere progression has now reached 2-factor authentication.  This just slipped in
                from an expert (who downplayed salt; yes, stretching is critical, but you would be crazy to stretch
                without salting too):</p>
                <blockquote>
                <p>But the real answer is things like two-factor authentication with smart phones. Two factor
                authentication seems like the answer to me. I think ten years from now this is going to be a common
                approach. [<a href="https://krebsonsecurity.com/2012/06/how-companies-can-beef-up-password-security/" target="_blank">Thomas H. Ptacek</a>]</p>
                </blockquote>
                <p>Its a step in the right direction of course.  But a chain is as weak as the weakest link and
                phone companies are very weak links indeed:</p>
                <p><!-- more -->Google send me an SMS with confirmation number when I log into gmail.  I
                like this feature.  But it can be overcome by a determined attacker who social-engineers the phone
                company.  Case in point: <a href="http://www.zdnet.com.au/googles-two-factor-glitch-ends-in-4chan-attack-339339127.htm" target="_blank">CloudFare hacked by password reset on gmail account</a>.</p>
                <p>My own interest is piqued because I too know someone who knows first hand about the
                spoofability of phone numbers :(</p>
                <p><strong>Their computer had a banking trojan</strong>.  The hacker logged into the
                bank website and transfered a large sum of money to the hacker’s own account.  The bank rang
                my friend to confirm such a large transfer (as is their routine policy).  <em>And the hacker
                answered</em>…</p>
                <p>The hacker had phoned British Telecom and reported a fault on his [as in the victim’s]
                fixed phone line.  The hacker asked BT to investigate and, in the meantime, redirect the victim’s
                phone to a pay-as-you-go mobile phone.</p>
                <p>It was that simple.</p>
                <p>The story gets all the more bizarre!  I’ll try and write it like I’m short
                of breath:</p>
                <p>Friend randomly logs into bank website and sees outstanding transfer and calls bank.  Bank
                un-transfers money, relief all round.  But bank then says “but we did transfer a large sum
                last week”…</p>
                <p>Luckily the police do investigate (apparently they mostly decline to) because there is video
                footage of someone(<a href="https://en.wikipedia.org/wiki/Money_mule" target="_blank">?</a>)
                withdrawing the money.  The bank un-transfers the first amount.</p>
                <p>Friend phones BT.  BT have a phone recording of the transfer being requested, but is spooky to
                listen to.  This is a common enough attack that BT have a system whereby you can put a <em>password</em>
                on your phone account so random people cannot redirect your phone…</p>
                <p>Not long after, mother rings friend… and call is answered by stange person instead! 
                The attacker had redirected the phone <em>again</em>.</p>
                <p>BT apologise.  The support line had asked for the password but validated it even though it was
                the <em>wrong</em> password.  What password had the attacker given?  BT had a recording
                again.  Attacker gave the friend’s <em>email</em> password.</p>
                <p>Friend has phone number of attacker.  Friend phones attacker.</p>
                <p>At first attacker pretends wrong number.  Then says ‘yeah, something is wrong with
                the phones, I keep getting your calls; phone company fault or something, goodbye’.  Then
                attacker changes tack; they are from the bank’s fraud department and they are investigating
                some irregularities and if friend can only confirm their details…  Crazy that all that can be
                in the same call conversation and yet it all so feel so <em>believable</em>.</p>
                <p>Attacker finally says to friend “I know all your details, I know all about you; if
                you let me get away with a little bit of money, I will leave you alone.&quot;  And then a
                negotiation on how much is a little bit proceeds.  Friend says &quot;I’ll think about it”
                and hangs up.</p>
                <p>I said it was bizarre.</p>
                <p>They key thing?  Phone company support staff have been successfully <a href="https://en.wikipedia.org/wiki/Social_engineering_%28security%29" target="_blank">socially
                engineered</a> from like forever, and for those preferring technical attacks <a href="https://en.wikipedia.org/wiki/Phone_cloning" target="_blank">phones can be cloned</a> too.</p>
                <p>2 factor authentication with phones is only going to be a small speed-bump against determined
                attackers.</p>
                <p><em>ADDED now in the same vein</em>:</p>
                <p>So lets iterate the ways the system failed:</p>
                <ul><li>his computer had a trojan</li>
                <li>his cleaning of the trojan between the calls obviously didn’t work effectively</li>
                <li>the bank was using password website login and phone-call confirmation</li>
                <li>as the vast majority of people phoning to report a fault are legitimate, there is no default
                security on call forwarding</li>
                <li>and BT doesn’t publicise the password protection it offers (to my knowledge)</li>
                <li>and BT’s own staff failed to actually confirm call transfers in this particular
                instance</li>
                <li>and the trojan failed in that it didn’t rewrite his bank view to hide its own
                transactions</li>
                <li>and the attacker failed to just transfer amounts under the limit that requires phone
                confirmation</li>
                </ul><p>Have I missed any?  Probably.</p>
                <p>I told him to burn and build.  I told him to use a <a href="https://www.knopper.net/knoppix/index-en.html" target="_blank">Knoppix CD</a> when using
                the computer for banking.  I don’t think I was heeded.</p>
                <p>Using bootable CDs for banking is a great idea.  Its impossible for a write-only media to get
                infected with a trojan that will survive a reboot.  I tried to get someone who has access to some shared
                accounts to use one, but sadly KHTML didn’t work with the banking website.  Arrrgggh.</p>
                <p>My banks all use <a href="https://en.wikipedia.org/wiki/Security_token" target="_blank">secure
                fobs</a>.  To log in on-line, and to confirm transactions, they present you with a challenge; you
                enter the challenge into the fob and then type the code it displays.</p>
                <p>The latest banking trojans are <a href="https://www.schneier.com/blog/archives/2009/09/hacking_two-fac.html" target="_blank">nasty
                pieces of work</a>.  They can piggy-back sessions where you are using a secure fob as two factor
                and add their own (hidden) transfers to your own.  I’ve heard of trojans that are adapted to
                my banks and their non-English language; these trojans are moving down to target even regional banks
                now.</p>
                <p>It annoys me that a trick is missed with the secure fob.  Imagine that:</p>
                <ul><li>the challenge screen includes the amount you are authorising</li>
                <li>and you type that amount into your secure fob along with the challenge code</li>
                </ul><p>It’d be <em>impossible</em> for a banking trojan to slip its
                own transfers in with a transaction I authorise.  Me, the human, will balk if the amount being
                authorised is too much.</p>
                <p>And I don’t think customers will think twice at being asked to enter the amount when
                they confirm transactions.  In fact, I think it feels natural.</p>
                <p>A <a href="https://news.ycombinator.com/item?id=4100614" target="_blank">comment</a>
                said this well; “<em>something I can access</em>” (the secure fob which
                can still be piggy backed) is not as strong a factor as “<strong>something I
                know/am/have</strong>” (the sum of the transaction).<br/></p>
            </post-body>
 <button class="page-link" onclick="window.location='classic.html#24949768311'">classic</button>  <button class="page-link" onclick="window.location='index4.html#24949768311'">index</button> 
    <span class="post-metadata"><i>posted 2012-06-12</i></span>
</div>
</div>
</div>


<div class="column">
    <div class="page-map">
        <h1 style="text-align: center">jump to &darr;</h1>
        <hr/>
        
            <div class="page-link" onclick="window.location='index.html'">main&nbsp;page&nbsp;&uarr;</div>
            <hr/>
        
        
            


        
            

    <div class="page-map-branch">
    <b>performance</b>
        
            <img class="feather" src="static/icons/bar-chart-2.svg"/>
        
        
            <div class="page-map-section">
            
                
                    <div class="page-map-leaf" onclick="window.location='post/172424230628.html'">Faster searches with non-prefix fields in composite indices</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/160628887798.html'">Compressing MySQL databases</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/53836725910.html'">What highscalability.com says about Scaling my Server</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/53751799442.html'">Scaling my Server: follow-up</div>
                
            
                
                    <div class="page-link" onclick="window.location='perf.html'">more&nbsp;&rarr;</div>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            </div>
        
    </div>


        
            

    <div class="page-map-branch">
    <b>old classics</b>
        
            <img class="feather" src="static/icons/book-open.svg"/>
        
        
            <div class="page-map-section">
            
                
                    <div class="page-map-leaf" onclick="window.location='post/49786413417.html'">The kid&#39;s computer</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/37291851878.html'">Making the History of Worlds Religions map</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/25564136097.html'">If you defend those involved in the OpenGL ES specification, you are an idiot</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/25426541504.html'">Stackoverflow unwinding?</div>
                
            
                
                    <div class="page-link" onclick="window.location='classic.html'">more&nbsp;&rarr;</div>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            </div>
        
    </div>


        
            

    <div class="page-map-branch">
    <b>general</b>
        
            <img class="feather" src="static/icons/terminal.svg"/>
        
        
            <div class="page-map-section">
            
                
                    <div class="page-map-leaf" onclick="window.location='post/134911547413.html'">Why Swift?</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/94734034483.html'">Python annotations and type checking</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/86488099258.html'">pycon 2014 Sweden: the bad bits</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/78636919764.html'">Table-based Template Translation in C++</div>
                
            
                
                    <div class="page-link" onclick="window.location='lang.html'">more&nbsp;&rarr;</div>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            </div>
        
    </div>


        
            

    <div class="page-map-branch">
    <b>recreation</b>
        
            <img class="feather" src="static/icons/youtube.svg"/>
        
        
            <div class="page-link" onclick="window.location='rec.html'">all&nbsp;&rarr;</div>
            <div class="page-map-section">
            
                

    <div class="page-map-branch">
    <b>games programming</b>
        
            <img class="feather" src="static/icons/play.svg"/>
        
        
            <div class="page-map-section">
            
                
                    <div class="page-map-leaf" onclick="window.location='post/57140204975.html'">Perlin Noise</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/57181055984.html'">Perlin Noise</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/53831974133.html'">Drawing RTS maps fast</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/49797579721.html'">WillCity update</div>
                
            
                
                    <div class="page-link" onclick="window.location='game.html'">more&nbsp;&rarr;</div>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            </div>
        
    </div>


            
                

    <div class="page-map-branch">
    <b>ludum-dare</b>
        
        
            <div class="page-map-section">
            
                
                    <div class="page-map-leaf" onclick="window.location='post/143376853353.html'">Ludum Dare #35 Mosaic</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/127137593983.html'">LudumDare 33 wallpapers</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/117234199303.html'">SSIM vs MSE for Mosaics</div>
                
            
                
                    <div class="page-map-leaf" onclick="window.location='post/97634254788.html'">Ludum Dare 30 results are in!</div>
                
            
                
                    <div class="page-link" onclick="window.location='ludum-dare.html'">more&nbsp;&rarr;</div>
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            </div>
        
    </div>


            
            </div>
        
    </div>


        
        
    </div>
</div>
</body>
</html>